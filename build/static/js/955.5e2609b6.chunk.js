"use strict";(self.webpackChunkvsa_website=self.webpackChunkvsa_website||[]).push([[955],{1033:(e,t,r)=>{r.d(t,{s:()=>n});var s=r(9950);function n(e){let{title:t}=e;return(0,s.useEffect)((()=>(document.title="VSA - ".concat(t),()=>{document.title="VSA"})),[t]),null}},1955:(e,t,r)=>{r.r(t),r.d(t,{Home:()=>w});var s=r(9950),n=r(5961),a=r(4414);function i(){const{signIn:e}=(0,n.A)(),[t,r]=(0,s.useState)(""),[i,o]=(0,s.useState)(""),[l,d]=(0,s.useState)(!1),[c,m]=(0,s.useState)(null);return(0,a.jsxs)("div",{className:"max-w-md mx-auto mt-8 p-6 bg-gray-800 rounded-lg shadow-xl",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center text-white",children:"Sign In"}),(0,a.jsxs)("form",{onSubmit:async r=>{r.preventDefault(),d(!0),m(null);try{await e(t,i)}catch(c){m(c instanceof Error?c.message:"Failed to sign in")}finally{d(!1)}},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email"}),(0,a.jsx)("input",{id:"email",type:"email",value:t,onChange:e=>r(e.target.value),required:!0,className:"mt-1 block w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Enter your email"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300",children:"Password"}),(0,a.jsx)("input",{id:"password",type:"password",value:i,onChange:e=>o(e.target.value),required:!0,className:"mt-1 block w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Enter your password"})]}),c&&(0,a.jsx)("div",{className:"p-3 rounded-md bg-red-900 text-red-300",children:c}),(0,a.jsx)("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-700 hover:bg-indigo-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:l?"Signing in...":"Sign In"})]})]})}var o=r(2348);function l(){const[e,t]=(0,s.useState)(""),[r,n]=(0,s.useState)(""),[i,l]=(0,s.useState)(""),[d,c]=(0,s.useState)(""),[m,u]=(0,s.useState)(!1),[h,g]=(0,s.useState)(null);return(0,a.jsxs)("div",{className:"max-w-md mx-auto mt-8 p-6 bg-gray-800 rounded-lg shadow-xl",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center text-white",children:"Sign Up"}),(0,a.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),u(!0),g(null);try{console.log("Starting sign up process...");const{data:{user:t},error:s}=await o.N.auth.signUp({email:e,password:r,options:{emailRedirectTo:"https://vsaatucsd.com",data:{first_name:i,last_name:d}}});if(console.log("Sign up response:",{user:t,signUpError:s}),s)throw console.error("Sign up error:",s),s;if(!t)throw console.error("No user returned from sign up"),new Error("No user returned from sign up");console.log("User created successfully"),g("Sign up successful! Please check your email to confirm your account.")}catch(s){console.error("Error in sign up process:",s),g(s instanceof Error?s.message:"Failed to sign up")}finally{u(!1)}},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-300",children:"First Name"}),(0,a.jsx)("input",{type:"text",id:"firstName",value:i,onChange:e=>l(e.target.value),className:"mt-1 block w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-300",children:"Last Name"}),(0,a.jsx)("input",{type:"text",id:"lastName",value:d,onChange:e=>c(e.target.value),className:"mt-1 block w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email"}),(0,a.jsx)("input",{type:"email",id:"email",value:e,onChange:e=>t(e.target.value),className:"mt-1 block w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300",children:"Password"}),(0,a.jsx)("input",{type:"password",id:"password",value:r,onChange:e=>n(e.target.value),className:"mt-1 block w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),h&&(0,a.jsx)("div",{className:"p-3 rounded-md bg-red-900 text-red-300",children:h}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-700 hover:bg-indigo-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:m?"Signing up...":"Sign Up"})]})]})}var d=r(8671),c=r(6268);function m(e){let{onPointsAdded:t}=e;const[r,n]=(0,s.useState)(""),[i,l]=(0,s.useState)(!1),[m,u]=(0,s.useState)(null),[h,g]=(0,s.useState)(null),{checkInWithCode:x}=(0,c.Z)(),{refreshPoints:p}=(0,d.m)();return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Check In"}),(0,a.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),r.trim())try{l(!0),u(null),g(null);const{data:e,error:s}=await o.N.from("events").select("*").eq("check_in_code",r.toUpperCase()).single();if(s)throw s;if(!e)return void u("Invalid code. Please try again.");if(e.is_code_expired)return void u("This code has expired.");const a=new Date(e.date),i=new Date;if((i.getTime()-a.getTime())/36e5>24)return void u("This event check-in period has ended.");await x(e.id,r.toUpperCase())&&(g("Successfully checked in to ".concat(e.name,"!")),n(""),await p(),null===t||void 0===t||t())}catch(s){console.error("Error submitting code:",s),u(s instanceof Error?s.message:"Failed to submit code. Please try again.")}finally{l(!1)}},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-300 mb-1",children:"Enter Check-in Code"}),(0,a.jsx)("input",{type:"text",id:"code",value:r,onChange:e=>n(e.target.value.toUpperCase()),placeholder:"Enter code",className:"w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-900 text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",disabled:i})]}),(0,a.jsx)("button",{type:"submit",disabled:i||!r.trim(),className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:i?"Checking in...":"Check In"}),m&&(0,a.jsx)("div",{className:"p-4 rounded-lg bg-red-900/20 text-red-400 text-sm",children:m}),h&&(0,a.jsx)("div",{className:"p-4 rounded-lg bg-green-900/20 text-green-400 text-sm",children:h})]})]})}var u=r(4158),h=r(1033),g=r(1132),x=r(7196),p=r(1850);const f=()=>(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-yellow-800 dark:text-yellow-200 mb-2",children:"\ud83d\udd27 Chat Assistant Setup Required"}),(0,a.jsxs)("div",{className:"text-xs text-yellow-700 dark:text-yellow-300 space-y-1",children:[(0,a.jsx)("p",{children:"To enable full AI functionality:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside ml-2 space-y-1",children:[(0,a.jsxs)("li",{children:["Get an OpenAI API key from ",(0,a.jsx)("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"platform.openai.com"})]}),(0,a.jsxs)("li",{children:["Create a ",(0,a.jsx)("code",{className:"bg-yellow-100 dark:bg-yellow-800 px-1 rounded",children:".env"})," file in the project root"]}),(0,a.jsxs)("li",{children:["Add: ",(0,a.jsx)("code",{className:"bg-yellow-100 dark:bg-yellow-800 px-1 rounded",children:"REACT_APP_OPENAI_API_KEY=your_key_here"})]}),(0,a.jsx)("li",{children:"Restart the development server"})]}),(0,a.jsxs)("p",{className:"mt-2 text-yellow-600 dark:text-yellow-400",children:[(0,a.jsx)("strong",{children:"Note:"})," The chat currently works with basic responses for common VSA questions."]})]})]});var b=r(6800);const y=()=>{const{messages:e,sendMessage:t,clearChat:r}=(0,p.Y)();return(0,a.jsxs)("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Chat Assistant Test"}),(0,a.jsx)(f,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Click the chat button in the bottom-right corner to test the assistant."}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:["What is VSA's mission?","How do I earn points?","What events are coming up?","Tell me about the 4 pillars"].map(((e,r)=>(0,a.jsx)("button",{onClick:()=>t(e),className:"px-3 py-1 bg-indigo-600 text-white text-sm rounded hover:bg-indigo-700",children:e},r)))}),(0,a.jsx)("button",{onClick:r,className:"px-3 py-1 bg-gray-600 text-white text-sm rounded hover:bg-gray-700",children:"Clear Chat"}),(0,a.jsx)("button",{onClick:()=>{(0,b.Z4)(),alert("Rate limit reset! You can now try the AI responses again.")},className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:"Reset Rate Limit"}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Messages: ",e.length]})})]})]})};function w(){const{user:e}=(0,n.A)(),[t,r]=(0,s.useState)(!1),[d,c]=(0,s.useState)(null),[p,f]=(0,s.useState)(!0),{events:b,loading:w,error:v}=(0,u.L)(),[j,N]=(0,s.useState)("");return(0,s.useEffect)((()=>{(async()=>{if(e)try{const{data:t,error:r}=await o.N.from("user_profiles").select("first_name, last_name").eq("id",e.id).single();if(r)return void console.error("Error fetching user profile:",r);t&&c("".concat(t.first_name||""," ").concat(t.last_name||"").trim()||"there")}catch(t){console.error("Error fetching user name:",t)}finally{f(!1)}else f(!1)})();const t=new Date;N(t.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}))}),[e]),p?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-950",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.s,{title:"Home"}),(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 text-gray-900 dark:bg-gray-950 dark:text-white pb-12 overflow-x-hidden transition-colors duration-300",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-6",children:e?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"relative rounded-2xl p-8 overflow-hidden bg-gradient-to-r from-indigo-600 to-purple-600",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 opacity-70"}),(0,a.jsxs)("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-center md:justify-between text-center md:text-left",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white/80 text-lg mb-2 text-center md:text-left",children:j}),(0,a.jsxs)("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-extrabold text-white mb-4",children:["Welcome to VSA, ",d||"there","!"]})]}),(0,a.jsx)("img",{src:"/images/vsa-logo.png",alt:"VSALogo",className:"h-24 md:h-40 w-auto mt-4 md:mt-0",loading:"lazy"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,a.jsx)(x.T,{children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-xl p-6 text-gray-900 dark:text-white",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Mission Statement"}),(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"The Vietnamese Student Association of UCSD strives to promote and preserve the Vietnamese culture. We are dedicated to providing resources and a safe space for students to unite as a Vietnamese-American community. This organization is for nonprofit."})]})}),(0,a.jsx)(x.T,{children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-xl p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:"Event Check-in"}),(0,a.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl shadow p-4",children:(0,a.jsx)(m,{})})]})}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-xl p-6 text-gray-900 dark:text-white",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Our 4 Pillars"}),(0,a.jsxs)("ul",{className:"list-disc list-inside text-gray-700 dark:text-gray-300 space-y-2",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Social:"})," meeting new people and building bonds with one another such as the ACE Program and House System"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Cultural:"})," stay in touch with cultural roots through our events such as Vietnamese Culture Night and Black April"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Community:"})," continue to strive to create a supportive and cooperative community for those of Vietnamese and non-Vietnamese descent"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Academic:"})," main priority of obtaining good grades and graduating within a reasonable amount of time"]})]})]})]}),(0,a.jsx)(x.T,{children:(0,a.jsx)("div",{className:"mt-8 bg-white dark:bg-gray-900 rounded-2xl shadow-xl p-6 text-gray-900 dark:text-white",children:(0,a.jsx)(y,{})})}),(0,a.jsx)(x.T,{children:(0,a.jsxs)("div",{className:"mt-8 bg-white dark:bg-gray-900 rounded-2xl shadow-xl p-6 text-gray-900 dark:text-white",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Upcoming Events"}),(0,a.jsx)(g.P.a,{href:"/events",className:"text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 dark:hover:text-indigo-300 transition-colors duration-200",whileHover:{scale:1.05},whileTap:{scale:.95},children:"See all events >"})]}),w?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):v?(0,a.jsxs)("div",{className:"text-center text-red-400 bg-red-900/20 p-4 rounded-lg",children:["Error loading events: ",v instanceof Error?v.message:"Unknown error"]}):(()=>{const e=new Date,t=new Date(e.getTime()-864e5),r=b.filter((e=>new Date(e.date)>=t)).sort(((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()));return 0===r.length?(0,a.jsxs)("div",{className:"bg-gray-800 shadow-xl rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Upcoming Events"}),(0,a.jsx)("p",{className:"text-gray-300",children:"No upcoming events at the moment."})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4 text-gray-900 dark:text-white flex flex-col",children:[(0,a.jsx)("img",{src:e.image_url||"/images/events/default.jpg",alt:e.name,className:"w-full h-40 object-cover rounded-md mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-bold mb-2",children:e.name}),(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:e.description}),(0,a.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:new Date(e.date).toLocaleDateString()}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-200 self-start mb-2",children:e.event_type.replace(/_/g," ").toUpperCase()})]},e.id)))})})()]})})]}):(0,a.jsxs)("div",{className:"max-w-2xl mx-auto py-12",children:[(0,a.jsxs)("div",{className:"text-center mb-12",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Welcome to VSA"}),(0,a.jsx)("p",{className:"text-xl text-gray-700 dark:text-gray-300",children:"Sign in or create an account to start earning points and participating in events."})]}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-2xl shadow-xl p-8",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l,{}),(0,a.jsxs)("p",{className:"mt-6 text-center text-gray-400",children:["Already have an account?"," ",(0,a.jsx)(g.P.button,{onClick:()=>r(!1),className:"text-indigo-400 hover:text-indigo-300 font-medium transition-colors duration-200",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Sign In"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i,{}),(0,a.jsxs)("p",{className:"mt-6 text-center text-gray-400",children:["Don't have an account?"," ",(0,a.jsx)(g.P.button,{onClick:()=>r(!0),className:"text-indigo-400 hover:text-indigo-300 font-medium transition-colors duration-200",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Sign Up"})]})]})})]})})})]})}},4158:(e,t,r)=>{r.d(t,{L:()=>a});var s=r(1920),n=r(2348);function a(){const{data:e=[],isLoading:t,error:r,refetch:a}=(0,s.useQuery)({queryKey:["events"],queryFn:async()=>{const{data:e,error:t}=await n.N.from("events").select("*").order("date",{ascending:!0});if(t)throw t;return e},staleTime:3e5});return{events:e,loading:t,error:r,refreshEvents:a}}},6268:(e,t,r)=>{r.d(t,{Z:()=>i});var s=r(8),n=r(9950),a=r(2348);function i(){const[e,t]=(0,n.useState)(!1),[r,i]=(0,n.useState)(null),o=(0,n.useCallback)((async(e,r)=>{try{t(!0),i(null),console.log("Starting check-in process:",{eventId:e,code:r});const{data:s,error:n}=await a.N.from("events").select("*").eq("id",e).single();if(console.log("Event fetch result:",{event:s,eventError:n}),n)throw console.error("Error fetching event:",n),n;if(!s)throw console.error("Event not found"),new Error("Event not found");if(s.is_code_expired)throw console.error("Code expired"),new Error("Check-in code has expired");if(s.check_in_code!==r)throw console.error("Invalid code:",{provided:r,expected:s.check_in_code}),new Error("Invalid check-in code");const{data:{user:o},error:l}=await a.N.auth.getUser();if(console.log("Current user:",{user:o,userError:l}),l)throw console.error("Error getting user:",l),l;if(!o)throw console.error("No user found"),new Error("User not authenticated");const{data:d,error:c}=await a.N.from("event_attendance").select("id, event_id, user_id").eq("event_id",e).eq("user_id",o.id).maybeSingle();if(console.log("Existing check-in check:",{existingCheckIn:d,checkInError:c}),c)throw console.error("Error checking existing check-in:",c),c;if(d)throw console.error("Already checked in"),new Error("You have already checked in to this event");console.log("Recording attendance with points:",s.points);const{data:m,error:u}=await a.N.from("event_attendance").insert({event_id:e,user_id:o.id,points_earned:s.points,check_in_type:"code"}).select().single();if(console.log("Insert result:",{insertData:m,insertError:u}),u)throw console.error("Error inserting attendance:",u),u;const{data:h,error:g}=await a.N.from("user_points").select("points").eq("user_id",o.id).single();if(console.log("Current points:",{currentPoints:h,currentPointsError:g}),g&&"PGRST116"!==g.code)throw console.error("Error getting current points:",g),g;const x=(null===h||void 0===h?void 0:h.points)||0,p=x+s.points;console.log("Updating points:",{currentTotal:x,newTotal:p,pointsToAdd:s.points});const{data:f,error:b}=await a.N.from("user_points").upsert({user_id:o.id,points:p},{onConflict:"user_id",ignoreDuplicates:!1}).select().single();if(console.log("Points update result:",{pointsData:f,pointsError:b}),b)throw console.error("Error updating points:",b),b;return console.log("Successfully checked in"),!0}catch(s){return console.error("Error in checkInWithCode:",s),i(s instanceof Error?s:new Error("Failed to check in")),!1}finally{t(!1)}}),[]),l=(0,n.useCallback)((async(e,r,s)=>{try{var n;t(!0),i(null);const{data:o,error:l}=await a.N.from("event_attendance").select("*").eq("event_id",e).eq("user_id",r).single();if(l&&"PGRST116"!==l.code)throw l;if(o)throw new Error("User has already checked in to this event");const{error:d}=await a.N.from("event_attendance").insert({event_id:e,user_id:r,points_earned:s,check_in_type:"manual",checked_in_by:null===(n=(await a.N.auth.getUser()).data.user)||void 0===n?void 0:n.id});if(d)throw d;return!0}catch(o){return i(o instanceof Error?o:new Error("Failed to check in")),!1}finally{t(!1)}}),[]),d=(0,n.useCallback)((async e=>{try{t(!0),i(null);const{data:r,error:s}=await a.N.from("event_attendance").select("\n          *,\n          user:user_id (\n            email,\n            user_profiles (\n              first_name,\n              last_name\n            )\n          )\n        ").eq("event_id",e).order("checked_in_at",{ascending:!1});if(s)throw s;return r}catch(r){return i(r instanceof Error?r:new Error("Failed to fetch attendance")),null}finally{t(!1)}}),[]),c=(0,n.useCallback)((async e=>{try{t(!0),i(null),console.log("Fetching attendance for user:",e);const{data:r,error:n}=await a.N.from("event_attendance").select("*").eq("user_id",e);console.log("Simple query result:",{simpleData:r,simpleError:n});const{data:o,error:l}=await a.N.from("event_attendance").select("\n          id,\n          event_id,\n          user_id,\n          points_earned,\n          check_in_type,\n          checked_in_at,\n          events!inner (\n            id,\n            name,\n            description,\n            date,\n            location,\n            points,\n            event_type,\n            check_in_form_url,\n            image_url,\n            check_in_code,\n            is_code_expired\n          )\n        ").eq("user_id",e).order("checked_in_at",{ascending:!1});if(console.log("Full query result:",{data:o,error:l}),l)throw console.error("Error fetching attendance:",l),l;const d=null===o||void 0===o?void 0:o.map((e=>(0,s.A)((0,s.A)({},e),{},{event:e.events[0]})));return console.log("Transformed data:",d),d}catch(r){return console.error("Error in getUserAttendance:",r),i(r instanceof Error?r:new Error("Failed to fetch attendance")),null}finally{t(!1)}}),[]);return{loading:e,error:r,checkInWithCode:o,manuallyCheckIn:l,getEventAttendance:d,getUserAttendance:c}}},7196:(e,t,r)=>{r.d(t,{T:()=>a});r(9950);var s=r(1132),n=r(4414);const a=e=>{let{children:t}=e;return(0,n.jsx)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:t})}}}]);